
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link href="~/Estilos/botonmodal.css" rel="stylesheet" type="text/css">
    <link href="~/Content/Chosen/chosen.min.css" rel="stylesheet" />
    <script>
       
        function myFunction1() {
            var x = document.getElementById("demo").value;
            window.open(x);
        }

        function myFunction2() {

            var x = document.getElementById("demo1").value;
            window.open(x);
            //document.getElementById("myImg").src = "https://zoom.us/wc/" + x + "/join?prefer=1&un=Users";

        }
    </script>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <script src="~/Scripts/menu.js"></script>
    <meta name="description" content="Responsive sidebar template with sliding effect and dropdown menu based on bootstrap 3">
    <title>CEMAQ - Diplomados</title>
    <link rel="stylesheet" type="text/css" href="~/Estilos/Maestra.css" />
    <link rel="icon" type="image/gif" href="~/Imagenes/CAPYBARA_TOGA.png">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"crossorigin="anonymous">
    <link href="https://use.fontawesome.com/releases/v5.0.6/css/all.css" rel="stylesheet">
    <script src="https://kit.fontawesome.com/2c36e9b7b1.js" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>

    
    <script src="~/Scripts/chosen.jquery.js"></script>
    <script src="~/Scripts/chosen.jquery.min.js"></script>


    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/modernizr")
</head>
<body>
    @Html.AntiForgeryToken()
    @{
        Plataforma_academica.Models.Login usu = Session["usuario"] as Plataforma_academica.Models.Login;
        Plataforma_academica.Models.Permisos_Menu menu = new Plataforma_academica.Models.Permisos_Menu();
        Plataforma_academica.Models.Permisos_Menu[] arreglo;
        Plataforma_academica.Models.principalP principal = new Plataforma_academica.Models.principalP();
        Plataforma_academica.Models.principalP[] arreglop;
        Plataforma_academica.Models.Niveles nivel = new Plataforma_academica.Models.Niveles();
        Plataforma_academica.Models.Niveles[] arreglo_nivel;
        Plataforma_academica.Models.Unidades unidad = new Plataforma_academica.Models.Unidades();
        Plataforma_academica.Models.Unidades[] arreglo_unidad;
        Plataforma_academica.Models.Actividades_unidad actividad = new Plataforma_academica.Models.Actividades_unidad();
        Plataforma_academica.Models.Actividades_unidad[] arreglo_actividad;
        Plataforma_academica.Models.Actividades_unidad[] arreglo_examen;
        Plataforma_academica.Models.Unidades[] arreglo_docente;
        Plataforma_academica.Models.Porcentaje_usuario porcentaje = new Plataforma_academica.Models.Porcentaje_usuario();
    }

    <header>
        <!-- Menu Header  -->
        <nav class="navbar" id="head">
            <!--Logo -->
            <a href="javascript:" onclick="window.open('https://cemaq.com.co/');" class="navbar-brand icono">
                <img src="~/Imagenes/LOGO CEMAQ PNG.png"></img>
            </a>
            <!-- Checkbox Color  -->
            <div class="slidermodo">
                <button class="switch" id="switch">
                    <span><i class="fas fa-sun"></i></span>
                    <span><i class="fas fa-moon"></i></span>
                </button>

            </div>
            <!-- Informacion del usuario  -->
            <div class="info">
                <div class="p-2">
                    <img class="perfil" src="~/Imagenes/@usu.foto">
                </div>
                <div class="p-2 nombre">
                    @{
                        if (usu != null)
                        {

                            if (Convert.ToInt32(usu.rol) < 4 || Convert.ToInt32(usu.rol) > 6)
                            {
                                <div>
                                    @Html.LabelFor(Model => usu.Nombre, usu.Nombre, new { @class = "" })
                                </div>

                                <div>
                                    @Html.LabelFor(Model => usu.Tipo_rol, usu.Tipo_rol, new { @class = "" })
                                    @Html.LabelFor(Model => usu.tipo_sangui, usu.tipo_sangui, new { @class = "" })
                                </div>
                            }
                            else
                            {
                                <div>
                                    @Html.LabelFor(Model => usu.Nombre, usu.Nombre, new { @class = "" })
                                </div>

                                <div>
                                    @Html.LabelFor(Model => usu.Tipo_rol, usu.Tipo_rol, new { @class = "" })
                                    @Html.LabelFor(Model => usu.tipo_sangui, usu.tipo_sangui, new { @class = "" })
                                </div>
                            }
                        }
                        else
                        {
                            <li>@Html.ActionLink("Plataforma Academica", "Login", "Login")</li>
                            <li>@Html.ActionLink("Acerca de", "About", "Home")</li>
                        }
                    }
                </div>
                <!--Contenedor del Menu izq-->
                <nav class="contenido ">
                    <!-- header nav-->
                    <div class="logo exterior" id="arriba">
                        <a>
                            <span class="fas fa-bars"></span>
                        </a>
                    </div>
                    <!-- contenido nav-->
                    <div class="lista-menu" id="menu">
                        <nav>

                            @{
                                if (usu != null)
                                {

                                    arreglo = menu.ConsultarMenu(usu.rol);

                                    for (int i = 0; i < arreglo.Length; i++)
                                    {
                                        <div class="opcion">
                                            <a style="color: white;">
                                                <img src="~/Imagenes/CAPYBARA_TOGA.png" /> @Html.ActionLink(arreglo[i].nombre, arreglo[i].accion, arreglo[i].controlador)
                                            </a>
                                        </div>

                                    }

                                }
                                else
                                {
                                    <li>@Html.ActionLink("Plataforma Academica", "Login", "Login")</li>
                                    <li>@Html.ActionLink("Acerca de", "About", "Home")</li>
                                }
                            }
                            @{
                                if (usu != null)
                                {
                                    if (Convert.ToInt32(usu.rol) < 4 || Convert.ToInt32(usu.rol) > 6)
                                    {

                                        @*<img src="~/Imagenes/bell-solid.svg" style="width: 22px; height: 27px;padding: 1%;margin-left: 2%; margin-right: 2%;" data-toggle="modal" data-target="#myModal" />
                                            <a href="https://zoom.us/signin" target="_blank">
                                                <img src="~/Imagenes/video-solid.svg" style="width: 22px; height: 27px;padding: 1%;margin-left: 2%; margin-right: 2%;" />
                                            </a>
                                            <a href="http://pizarravirtualamazoniantic.azurewebsites.net/" target="_blank">
                                                <img src="~/Imagenes/chalkboard-teacher-solid.svg" style="width: 27px;padding: 1%; height: 27px;margin-left: 2%; margin-right: 2%;" />
                                            </a>*@
                                        <img src="~/imagen_multimedia/persona (2).svg" style="width: 25px; height: 27px;padding: 1%;margin-left: 2%; margin-right: 2%;" data-toggle="modal" data-target="#myModal" />


                                    }
                                    else
                                    {
                                        @*<img src="~/Imagenes/bell-solid.svg" style="width: 22px; height: 27px;padding: 1%;margin-left: 2%; margin-right: 2%;" />*@
                                        @*<a href="#"><img src="~/Imagenes/video-solid.svg" style="width: 22px; height: 27px;padding: 1%;margin-left: 2%; margin-right: 2%;" data-toggle="modal" data-target="#myModal1" /></a>
                                            <a href="#"><img src="~/Imagenes/chalkboard-teacher-solid.svg" style="width: 27px;padding: 1%; height: 27px;margin-left: 2%; margin-right: 2%;" data-toggle="modal" data-target="#myModal2" /></a>*@
                                        <a href="/Editar_perfil/Editar_perfil"><img src="~/imagen_multimedia/persona (2).svg" style="width: 25px; height: 27px;padding: 1%;margin-left: 2%; margin-right: 2%;" /></a>
                                    }
                                }
                            }
                            <div class="opcion">
                                <a href="/Login/cerrarsesion">
                                    <img src="~/Imagenes/CAPYBARA_TOGA.png" /> Cerrar Sesion
                                </a>
                            </div>

                        </nav>
                    </div>

                </nav>

            </div>
        </nav>
    </header>

    <!-- Contenedor para despues del Header -->

    <main class="principal">
        <!-- Menu izq  -->
        <div class="menu-izq">
            @{

                if (Convert.ToInt32(usu.rol) == 4)
                {
                    <!--Estudiante-->
                    using (Html.BeginForm("principalplataforma", "PrincipalPlataforma", FormMethod.Post, new { enctype = "multipart/form-data" }))
                    {
                        if (usu != null)
                        {

                            arreglop = principal.BuscarCursos(usu.cedula);
                            if (arreglop.Length == 0)
                            {
                                <script> window.location.href ='@Url.Action("Principal_todos", "Principal_todos")'; </script>
                            }

                            for (int i = 0; i < arreglop.Length; i++)
                            {
                                if (DateTime.Today < arreglop[i].fecha_cierre)
                                {
                                    TimeSpan dias_faltantes = arreglop[i].fecha_cierre - DateTime.Today;
                                    <button type="submit" class="boton pendiente" name="ir" value="@arreglop[i].codigo_curso">
                                        <div class="content-btn">
                                            <section class="izq"></section>
                                            <section class="cent">
                                                <p class="nom">@arreglop[i].nombre_curso</p>
                                                <div class="progress ">
                                                    <div class="progress-bar progress-bar-success progress-bar-striped " style="width:@arreglop[i].porcentaje_diplomado% ; box-shadow:-1px 0px 0px rgba(91, 192, 222, 0.7);">
                                                        <h6 class="porcentaje">@arreglop[i].porcentaje_diplomado%</h6>
                                                    </div>
                                                </div>

                                            </section>
                                            <section class="der">
                                                <span class="msjem">@Convert.ToInt32(dias_faltantes.Days) dias</span>
                                            </section>

                                        </div>
                                    </button>
                                    <div class="contener" id="modulo">
                                        
                                        @{
                                            //Modulo
                                            if (TempData["mensaje9"] != null && usu != null)
                                            {
                                                TempData.Keep("mensaje9");
                                                string nc = Convert.ToString(TempData["mensaje9"]);
                                                arreglo_unidad = unidad.Consultar_unidades_usuario(nc, usu.usuario);
                                                if (arreglo_unidad[0].presentacion == "saludar")
                                                {
                                                    @Scripts.Render("~/Scripts/Emerentelogin.js")
                                                }
                                                <!--Boton De Inforamcion del Docente-->
                                                <button class="boton" data-target="#mostrarmodal2" data-toggle="modal">
                                                    <div class="content-btn">
                                                        <section class="izq"></section>
                                                        <section class="cent">
                                                            <span><strong>Información docente</strong></span>
                                                        </section>
                                                        <!--<img src="~/imagen_multimedia/Presentacion Docente.png" />-->

                                                    </div>
                                                </button>

                                                for (int j = 0; j < arreglo_unidad.Length; j++)
                                                {
                                                    <!--Modulo 1-->
                                                    if (j == 0)
                                                    {
                                                        <button type="submit" class="boton" name="irrr" value="@arreglo_unidad[j].codigo_unidad">
                                                            <div class="content-btn">
                                                                <section class="izq"></section>
                                                                <section class="cent">
                                                                    <p class="nom">@arreglo_unidad[j].nombre_unidad</p>
                                                                    <div class="progress">
                                                                        <div class="progress-bar progress-bar-success progress-bar-striped " style="width:@arreglo_unidad[j].porcentaje_modulo% ; box-shadow:-1px 0px 0px rgba(91, 192, 222, 0.7);">
                                                                            <h6 class="porcentaje">@arreglo_unidad[j].porcentaje_modulo%</h6>
                                                                        </div>
                                                                    </div>
                                                                </section>                                                           
                                                                
                                                            </div>
                                                            <script>
                                                                var checkBox = document.getElementById("unidad");
                                                                checkBox.checked = "checked"
                                                            </script>
                                                        </button>
                                                    }
                                                    else
                                                    {
                                                        <!--Modulo 2-5 -->
                                                        if (Convert.ToSingle(arreglo_unidad[j - 1].porcentaje_modulo) < 99)
                                                        {
                                                            <button type="submit" disabled="true" class="boton pendiente" @*value="@arreglo_unidad[i].codigo_unidad"*@>
                                                                <div class="content-btn">
                                                                    <section class="izq"></section>
                                                                    <section class="cent"><p class="nom">@arreglo_unidad[j].nombre_unidad</p></section>
                                                                    <section class="der"><span class="msjem" id="msejem">Modulo Pendiente</span> </section>
                                                                    <!--<img src="~/imagen_multimedia/Modulo.png" />-->
                                                                    
                                                                    
                                                                </div>
                                                            </button>
                                                        }
                                                        else
                                                        {
                                                            <button type="submit" class="boton" name="irrr" value="@arreglo_unidad[j].codigo_unidad">
                                                                <div class="content-btn">
                                                                    <img src="~/imagen_multimedia/Modulo.png" />
                                                                    <div class="progress ">
                                                                        <div class="progress-bar progress-bar-success progress-bar-striped " style="width:@arreglo_unidad[i].porcentaje_modulo% ; box-shadow:-1px 0px 0px rgba(91, 192, 222, 0.7);">
                                                                            <h6 class="porcentaje">@arreglo_unidad[j].porcentaje_modulo%</h6>
                                                                        </div>
                                                                    </div>
                                                                    <p class="nom">@arreglo_unidad[j].nombre_unidad</p>
                                                                </div>
                                                            </button>
                                                        }
                                                    }
                                                }

                                                TempData["mensaje9"] = null;
                                            }
                                            else
                                            {
                                                <a> Elija un Diplomado</a>
                                            }
                                        }
                                    </div>

                                }
                                else
                                {
                                    if (DateTime.Today == arreglop[i].fecha_cierre)
                                    {
                                        <button type="submit" class="boton" name="ir" value="@arreglop[i].codigo_curso">
                                            <div class="content-btn">
                                                <div class="progress ">
                                                    <div class="progress-bar progress-bar-success progress-bar-striped " style="width:@arreglop[i].porcentaje_diplomado% ; box-shadow:-1px 0px 0px rgba(91, 192, 222, 0.7);">
                                                        <h6 class="porcentaje">@arreglop[i].porcentaje_diplomado%</h6>
                                                    </div>
                                                </div>
                                                <p class="nom">@arreglop[i].nombre_curso</p>
                                            </div>
                                        </button>
                                    }
                                    else
                                    {
                                        //crear un script con json para actualizar automaticamente el estado de curso_usuario para que no se carque mas el curso que ya se paso de fecha
                                        <script>
                                $(function () {
                                    var url = "@Url.Action("finalizado_por_fecha", "PrincipalPlataforma")";
                                    var codigo = @arreglop[i].codigo_curso_usaurio;
                                    var data = {codigo : codigo};
                                    $.post(url,data).done(function(data){

                                    }).fail(manejarErrorAjax).always(function(){
                                    });
                                });
                                        </script>
                                    }
                                }
                            }
                        }
                    }
                }
                else
                {
                    if (Convert.ToInt32(usu.rol) > 0 && Convert.ToInt32(usu.rol) < 3)
                    {
                        <!--Administrador y lideres-->
                        using (Html.BeginForm("seleccionar_unidad_para_contenido", "Seleccionar_para_subir_contenido", FormMethod.Post, new { enctype = "multipart/form-data" }))
                        {
                            if (usu != null)
                            {

                                if (Convert.ToInt32(usu.rol) == 7)
                                {
                                    arreglop = principal.BuscarCursosDocentes(usu.cedula);
                                }
                                else
                                {
                                    arreglop = principal.BuscarCursosgeneral();
                                }

                                for (int i = 0; i < arreglop.Length; i++)
                                {
                                    <button type="submit" class="boton" name="ir" value="@arreglop[i].codigo_curso">
                                        <div class="content-btn">
                                            <section class="izq">
                                            </section>
                                            <section class="cent">
                                                <p class="nom">@arreglop[i].nombre_curso</p>
                                            </section>


                                        </div>
                                    </button>

                                    //

                                    if (TempData["mensaje10"] != null && usu != null)
                                    {
                                                                    //Modulos
                                        TempData.Keep("mensaje10");
                                        string nc = Convert.ToString(TempData["mensaje10"]);
                                        arreglo_unidad = unidad.Consultar_unidades_grupo(nc);

                                        for (int j = 0; j < arreglo_unidad.Length; j++)
                                        {
                                            <button type="submit" class="boton" name="ir3" value="@arreglo_unidad[j].codigo_unidad">
                                                <div class="content-btn">
                                                    <section class="izq"></section>
                                                    <section class="cent">
                                                        <p>@arreglo_unidad[j].nombre_unidad</p>
                                                    </section>
                                                    
                                                </div>
                                                <script>
                                                    var checkBox = document.getElementById("unidad");
                                                    checkBox.checked = "checked"
                                                </script>
                                            </button>
                                        }
                                        TempData["mensaje10"] = null;
                                    }
                                    else
                                    {
                                        <a>Elija un Diplomado</a>
                                    }

                                }
                            }
                        }
                    }
                }
            }



        </div>

        <!-- Menu Derecho
    <nav class="menu-der">
        <ul class="contenido list-group">
        </ul>
    </nav>

        -->
        <!-- Contenedor Seleccionar_unidad  -->
        <div class="contenedor" id="container">
            @RenderBody()
        </div>


    </main>


    <script src="~/Scripts/Menuprincipal.js"></script>
    <script>
        AjustarTextArea();
        function AjustarTextArea() {
            var tx = document.getElementsByTagName('textarea');
            for (var i = 0; i < tx.length; i++) {
                tx[i].style.height = (tx[i].scrollHeight) + 'px';
                console.log(tx[i].scrollHeight)
            }
        }
    </script>
    <!-- page-wrapper -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
            crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
            crossorigin="anonymous"></script>

    @Scripts.Render("~/bundles/jquery")
    @Scripts.Render("~/bundles/bootstrap")
    @RenderSection("scripts", required: false)
    <script src="~/Scripts/chosen.jquery.min.js"></script>

    <script src="~/Scripts/Modooscuro.js"></script>
</body>


</html>


<!--

<div class="modal fade" id="myModal1" role="dialog">
    <div class="modal-dialog" style="position: initial;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title" style="position: absolute;">VideoConferencia en Zoom</h4>
            </div>
            <div class="modal-body">
                <p>Ingrese el link proporcionado por el docente para acceder a la conferencia</p>
                <input type="text" id="demo1" class="form-control" />
            </div>
            <div class="modal-footer">
                <button class="btn1 btn1-dark" style="color: white;" onclick="myFunction2()">Acceder a reunionvirtual</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="myModal2" role="dialog">
    <div class="modal-dialog" style="position: initial;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title" style="position: absolute;">Pizarra Virtual</h4>
            </div>
            <div class="modal-body">
                <p>Ingrese el link propocionado por el docente para acceder a la clase en la pizarra virtual</p>
                <input type="text" id="demo" class="form-control" />
            </div>
            <div class="modal-footer">
                <button class="btn1 btn1-dark" style="color: white;" onclick="myFunction1()">Acceder a Pizarra</button>
            </div>
        </div>
    </div>


</div>-->
